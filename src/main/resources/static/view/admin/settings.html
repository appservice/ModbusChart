<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Insert title here</title>
</head>
<body>


	<div class="page-header">
		<h3>Ustawienia</h3>
	</div>
	<div class="row">
		<div class="col-md-12">
			<div class="jumbotron " style="min-width: 45em;">
				<h2>PLC</h2>

				<table class="table table-striped table-bordered" style="min-width: 250pt;">
					<tr>
						<!--  <th>LP</th> -->
						<th>Nazwa</th>
						<th>IP</th>
						<th>Port</th>
						<th>Interwał [ms]</th>
						<th>Co który pomiar pokazać</th>

						<th>Typ danych</th>
						<th style="width: 100px" title="Współczynnik do wyskalowania czujników przepływu powietrza">Współczynnik_1 </th>
						<th style="width: 100px" title="Współczynnik do wyskalowania licznika poboru energii elektrycznej">Współczynnik_2 </th>
						<!-- <th>Ilość czujników</th> -->
						<th title="Początkowy adres odczytywanych rejestrów">Adres rejestru</th>


					</tr>

					<tr data-ng-repeat="server in serversList">
						<!--    <td>{{$index+1}}</td> -->
						<td>{{server.name}}</td>
						<td>{{server.ip}}</td>
						<td>{{server.port}}</td>
						<td>{{server.timeInterval}}</td>
						<td>{{server.savedMeasurementNumber}}</td>
						<td>{{server.readedDataType}}</td>
						
						<td>{{server.scaleFactor}}</td>
						<td>{{server.scaleFactorForElectricEnergy}}</td>
						<!--    <td>{{server.readedDataCount}}</td>-->
						<td>{{server.firstRegisterPos}}</td>
						<!-- <td><a href="#" data-toggle="modal" data-target="#editServerDialog" data-ng-click="preEditServer(server)">Edytuj</a></td> -->
						<!--  <td><a  data-ng-click="removeServer(server)">Usuń </a></td> -->
						<!--   <td><a href="#" data-ng-click="runServer(server)">Włącz </a></td> -->
						<!--   <td><a href="#" data-ng-click="stopServer(server)">Wyłącz </a></td> -->

					</tr>


				</table>
				<button class="btn btn-primary" data-toggle="modal" data-target="#newServerDialog" data-ng-show="!isButtonShowed">
					Dodaj nowy <i class="glyphicon glyphicon-plus"></i>
				</button>
				<button class="btn btn-primary" data-toggle="modal" data-target="#editServerDialog" data-ng-show="isButtonShowed"
					data-ng-click="preEditServer(serversList[0])">
					<!-- data-ng-disabled="false" -->
					Edytuj <i class="glyphicon glyphicon-edit"></i>
				</button>
				<!--     <button class="btn btn-primary" data-ng-show="isButtonShowed" data-ng-click="removeServer(serversList[0])">
          Usuń <i class="glyphicon glyphicon-remove"></i>
        </button>-->
				<span>
					<button class="btn btn-danger " data-ng-show="isButtonShowed" data-ng-click="runServer(serversList[0])">
						Włącz <i class="glyphicon glyphicon-play"></i>
					</button>
					<button class="btn btn-danger " data-ng-show="isButtonShowed" data-ng-click="stopServer(serversList[0])">
						Wyłącz <i class="glyphicon glyphicon-stop"></i>
					</button>
				</span>


			</div>
		</div>



	</div>

	<!--  ---------------------lista    sensorów ------------------------------------ -->
	<div class="row">
		<div class="col-lg-6" data-ng-show="isButtonShowed">
			<div class="jumbotron  my_table">
				<h2>Lista czujników przepływu</h2>
				<ul data-ng-repeat="server in serversList" class="list-inline">
					<li>

						<table class="table table-striped table-bordered">
							<tr>
								<th>LP</th>
								<th>Nazwa</th>
								<th></th>
							</tr>
							<tr data-ng-repeat="sensorName in server.sensorsName">
								<td>{{$index+1}}</td>
								<td>{{sensorName}}</td>
								<td>
									<button data-ng-click="deleteSensorsName(server,$index)" class="btn btn-default">Usuń</button>
								</td>
							</tr>
						</table>



					</li>

				</ul>
				<button class="btn btn-default" data-toggle="modal" data-target="#updatedSensorsNameDialog">Dodaj czujnik</button>


			</div>
		</div>

		<!--  --------------------- wartoc ceny energii  ------------------------------------ -->

		<div class="col-lg-6">
			<div class="jumbotron">
				<h2>Koszt 1 kWh</h2>
				 {{preferences.currentPrice|currency}}
				 	<button class="btn btn-primary" data-toggle="modal" data-target="#updatePriceModal"
								data-ng-click="preEditUser(user)">
								Edytuj <i class="glyphicon glyphicon-edit"></i></button>
			</div>
		</div>

		<!--  ---------------------lista    użytkowników ------------------------------------ -->

		<div class="col-lg-6">
			<div class="jumbotron">
				<h2>Lista użytkowników</h2>


				<table class="table table-striped table-bordered">

					<tr>
						<th>LP</th>
						<th>Nazwa</th>
						<th>Rola</th>
						<th>Aktywny</th>
						<th></th>
						<th></th>
					</tr>
					<tr data-ng-repeat="user  in users">
						<td>{{$index+1}}</td>
						<td>{{user.userName}}</td>
						<td data-ng-show="user.roles.indexOf('ROLE_ADMIN')>-1">Administrator</td>
						<td data-ng-show="user.roles.indexOf('ROLE_ADMIN')<0">Użytkownik</td>
						<td>
							<input type="checkbox" data-ng-checked="user.enabled" disabled="disabled" />
						</td>
						<td>
							<button class="btn btn-primary" data-toggle="modal" data-target="#updateUserDialog"
								data-ng-click="preEditUser(user)">
								Edytuj <i class="glyphicon glyphicon-edit"></i>
							</button>
						</td>
						<td>
							<button data-ng-click="deleteUser(user);" class="btn btn-default">Usuń</button>
						</td>

					</tr>
				</table>



				<button class="btn btn-default" data-toggle="modal" data-target="#newUserDialog">Dodaj użytkownika</button>


			</div>
		</div>
	</div>


	<!-- ==================modal dialog add new server =========================== -->
	<!-- Modal -->
	<form name="newServerForm" novalidate>
		<div class="modal fade" id="newServerDialog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
			aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
						<h4 class="modal-title" id="myModalLabel">Dodaj</h4>
					</div>
					<div class="modal-body">


						<div class="form-horizontal">
							<label for="input_name" class="control-label">Nazwa:</label>
							<span class="alert-danger" data-ng-show="newServerForm.name.$error.required"> Wymagana!</span>
							<input name="name" type="text" class="form-control" id="input_name" data-ng-model="newServer.name" required>
							<label for="input_ip" class="control-label">IP:</label>
							<span class="alert-danger" data-ng-show="newServerForm.ip.$error.required"> Wymagane!</span>
							<span class="alert-danger" data-ng-show="newServerForm.ip.$error.pattern">Zły format ip!</span>
							<input name="ip" type="text" class="form-control" id="input_ip" data-ng-model="newServer.ip" required="required"
								data-ng-pattern='/\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/' placeholder='xxx.xxx.xxx.xxx'>

							<!-- port  -->
							<label for="input_port" class="control-label">Port:</label>
							<span class="alert-danger" data-ng-show="newServerForm.port.$error.required"> Wymagany!</span>
							<span class="alert-danger" data-ng-show="newServerForm.port.$error.number">Zły format danych! Wymagana
								liczba z przedziału 1-65535</span>
							<span class="alert-danger" data-ng-show="newServerForm.port.$error.max">Zły format danych! Wymagana liczba
								z przedziału 1-65535</span>
							<input name="port" type="number" class="form-control" id="input_port" data-ng-model="newServer.port"
								required="required" max="65535">

							<!-- interwal -->
							<label for="input_time" class="control-label">Interwał [ms]:</label>
							<span class="alert-danger" data-ng-show="newServerForm.interval.$error.required"> Wymagany!</span>
							<span class="alert-danger" data-ng-show="newServerForm.interval.$error.min">Minimalny intewał to 20 ms!</span>
							<span class="alert-danger" data-ng-show="newServerForm.interval.$error.number">Zły format danych! Wymagana
								liczba!</span>
							<input name="interval" type="number" class="form-control" id="input_time" data-ng-model="newServer.timeInterval"
								required min="20">


							<!-- sampler -->
							<label for="input_saved_measurement_number" class="control-label">Co który pomiar pokazać:</label>
							<span class="alert-danger" data-ng-show="newServerForm.savedMeasurementNumber.$error.required"> Wymagany!</span>
							<span class="alert-danger" data-ng-show="newServerForm.savedMeasurementNumber.$error.min">Minimalna
								wartość to 1!</span>
							<span class="alert-danger" data-ng-show="newServerForm.savedMeasurementNumber.$error.number">Zły format
								danych! Wymagana liczba!</span>
							<input name="savedMeasurementNumber" type="number" class="form-control" id="input_saved_measurement_number"
								data-ng-model="newServer.savedMeasurementNumber" required min="1">


							<!-- readedDataTypes -->
							<label for="input_type" class="control-label">Typ danych:</label>
							<span class="alert-danger" data-ng-show="newServerForm.readedDataType.$error.required"> Wymagany!</span>
							<select name="readedDataType" id="input_type" class="form-control" data-ng-model="newServer.readedDataType"
								data-ng-options="dataTypes.type as dataTypes.name for dataTypes in readedDataTypes" required>
							</select>

							<!-- saleFactor -->
							<label for="input_saved_scale_factor" class="control-label">Współczynnik skalowania licznika energii el:</label>
							<span class="alert-danger" data-ng-show="newServerForm.savedScaleFactor.$error.required"> Wymagany!</span>
							<span class="alert-danger" data-ng-show="newServerForm.savedScaleFactor.$error.number">Zły format danych!
								Wymagana liczba!</span>
							<input name="savedScaleFactor" type="number" class="form-control" id="input_saved_scale_factor"
								data-ng-init="newServer.scaleFactor=0.0027466659" data-ng-model="newServer.scaleFactor" required> 
								
								
							<!-- saleFactorEmergy -->
							<label for="input_saved_scale_factor_energy" class="control-label">Współczynnik skalowania licznika energii el:</label>
							<span class="alert-danger" data-ng-show="newServerForm.savedScaleFactorEnergy.$error.required"> Wymagany!</span>
							<span class="alert-danger" data-ng-show="newServerForm.savedScaleFactorEnergy.$error.number">Zły format danych!
								Wymagana liczba!</span>
							<input name="savedScaleFactorEnergy" type="number" class="form-control" id="input_saved_scale_factor_energy"
								data-ng-init="newServer.scaleFactorForElectricEnergy=1" data-ng-model="newServer.scaleFactorForElectricEnergy" required> 
								
								<label
								for="input_pos" class="control-label">Adres pierwszego rejestru:</label>
							<span class="alert-danger" data-ng-show="newServerForm.firstRegisterPos.$error.required"> Wymagany!</span>
							<span class="alert-danger" data-ng-show="newServerForm.firstRegisterPos.$error.number">Zły format danych!
								Wymagana liczba!</span>
							<input name="firstRegisterPos" type="number" class="form-control" id="nput_pos"
								data-ng-model="newServer.firstRegisterPos" required>
						</div>


					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Anuluj</button>
						<button type="button" class="btn btn-primary" data-ng-click="addNewServer(newServer)" data-dismiss="modal"
							data-ng-disabled="newServerForm.$invalid">Zapisz</button>
					</div>

				</div>
			</div>
		</div>
	</form>
	<!-- ==================modal dialog edit server =========================== -->
	<!-- Modal -->
	<form name="updatedServerForm" novalidate>
		<div class="modal fade" id="editServerDialog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
			aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
						<h4 class="modal-title" id="myModalLabel">Edytuj</h4>
					</div>
					<div class="modal-body">

						<div class="form-group">
							<label for="input_name" class="control-label">Nazwa:</label>
							<span class="alert-danger" data-ng-show="updatedServerForm.name.$error.required"> Wymagana!</span>
							<input name="name" type="text" class="form-control" id="input_name" data-ng-model="updatedServer.name" required>
							<label for="input_ip" class="control-label">IP:</label>
							<span class="alert-danger" data-ng-show="updatedServerForm.ip.$error.required"> Wymagane!</span>
							<span class="alert-danger" data-ng-show="updatedServerForm.ip.$error.pattern">Zły format ip!</span>
							<input name="ip" type="text" class="form-control" id="input_ip" data-ng-model="updatedServer.ip"
								required="required" data-ng-pattern='/\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/' placeholder='xxx.xxx.xxx.xxx'>

							<!-- port  -->
							<label for="input_port" class="control-label">Port:</label>
							<span class="alert-danger" data-ng-show="updatedServerForm.port.$error.required"> Wymagany!</span>
							<span class="alert-danger" data-ng-show="uupdatedServerForm.port.$error.number">Zły format danych!
								Wymagana liczba z przedziału 1-65535</span>
							<span class="alert-danger" data-ng-show="updatedServerForm.port.$error.max">Zły format danych! Wymagana
								liczba z przedziału 1-65535</span>
							<input name="port" type="number" class="form-control" id="input_port" data-ng-model="updatedServer.port"
								required="required" max="65535">

							<!-- interwal -->
							<label for="input_time" class="control-label">Interwał [ms]:</label>
							<span class="alert-danger" data-ng-show="updatedServerForm.interval.$error.required"> Wymagany!</span>
							<span class="alert-danger" data-ng-show="updatedServerForm.interval.$error.min">Minimalny intewał to 20
								ms!</span>
							<span class="alert-danger" data-ng-show="updatedServerForm.interval.$error.number">Zły format danych!
								Wymagana liczba!</span>
							<input name="interval" type="number" class="form-control" id="input_time"
								data-ng-model="updatedServer.timeInterval" required min="20">

							<!-- sampler -->
							<label for="input_saved_measurement_number" class="control-label">Co który pomiar pokazać:</label>
							<span class="alert-danger" data-ng-show="updatedServerForm.savedMeasurementNumber.$error.required">
								Wymagany!</span>
							<span class="alert-danger" data-ng-show="updatedServerForm.savedMeasurementNumber.$error.min">Minimalna
								wartość to 1!</span>
							<span class="alert-danger" data-ng-show="updatedServerForm.savedMeasurementNumber.$error.number">Zły
								format danych! Wymagana liczba!</span>
							<input name="savedMeasurementNumber" type="number" class="form-control" id="input_saved_measurement_number"
								data-ng-model="updatedServer.savedMeasurementNumber" required min="1">

							<!-- readedDataTypes -->
							<label for="input_type" class="control-label">Typ danych:</label>
							<span class="alert-danger" data-ng-show="updatedServerForm.readedDataType.$error.required"> Wymagany!</span>
							<select name="readedDataType" id="input_type" class="form-control" data-ng-model="updatedServer.readedDataType"
								data-ng-options="dataTypes.type as dataTypes.name for dataTypes in readedDataTypes" required>
							</select>

							<!-- saleFactor -->
							<label for="input_saved_scale_factor" class="control-label">Współczynnik skalowania czujników przepływu</label>
							<span class="alert-danger" data-ng-show="updatedServerForm.savedScaleFactor.$error.required"> Wymagany!</span>
							<span class="alert-danger" data-ng-show="updatedServerForm.savedScaleFactor.$error.number">Zły format
								danych! Wymagana liczba!</span>
							<input name="savedScaleFactor" type="number" class="form-control" id="input_saved_scale_factor"
								data-ng-model="updatedServer.scaleFactor" required>


		<!-- saleFactorEnergy -->
							<label for="input_saved_scale_factor_energy" class="control-label">Współczynnik skalowania licznika energii el.</label>
							<span class="alert-danger" data-ng-show="updatedServerForm.savedScaleFactorEnergy.$error.required"> Wymagany!</span>
							<span class="alert-danger" data-ng-show="updatedServerForm.savedScaleFactorEnergy.$error.number">Zły format
								danych! Wymagana liczba!</span>
							<input name="savedScaleFactorEnergy" type="number" class="form-control" id="input_saved_scale_factor_energy"
								data-ng-model="updatedServer.scaleFactorForElectricEnergy" required>

							<!-- readeDataCount -->
							<!--	<label for="input_count" class="control-label">Ilość czujników:</label> <span class="alert-danger"
								data-ng-show="updatedServerForm.readedDataCount.$error.required"> Wymagany!</span> <span class="alert-danger"
								data-ng-show="updatedServerForm.readedDataCount.$error.number">Zły format danych! Wymagana liczba!</span> <input
								name="readedDataCount" type="number" class="form-control" id="input_count"
								data-ng-model="updatedServer.readedDataCount" required>-->
							<label for="input_pos" class="control-label">Adres pierwszego rejestru:</label>
							<span class="alert-danger" data-ng-show="updatedServerForm.firstRegisterPos.$error.required"> Wymagany!</span>
							<span class="alert-danger" data-ng-show="updatedServerForm.firstRegisterPos.$error.number">Zły format
								danych! Wymagana liczba!</span>
							<input name="firstRegisterPos" type="number" class="form-control" id="nput_pos"
								data-ng-model="updatedServer.firstRegisterPos" required>
						</div>


					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Anuluj</button>
						<button type="button" class="btn btn-primary" data-ng-click="updateServer(updatedServer)" data-dismiss="modal">Zapisz</button>
					</div>
				</div>
			</div>
		</div>
	</form>
	<!-- =========================================================================== -->



	<!-- ==================modal dialog edit sernsorsName =========================== -->
	<!-- Modal -->
	<form name="updatedSensorsName" novalidate>
		<div class="modal fade" id="updatedSensorsNameDialog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
			aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
						<h4 class="modal-title" id="myModalLabel">Edytuj</h4>
					</div>
					<div class="modal-body">

						<div class="form-group">
							<label for="input_name" class="control-label">Nazwa:</label>
							<span class="alert-danger" data-ng-show="updatedSensorsName.name.$error.required"> Wymagana!</span>
							<input name="name" type="text" class="form-control" id="input_name" data-ng-model="serverName" required>
						</div>


					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Anuluj</button>
						<button type="button" class="btn btn-primary" data-ng-click="addSensorsName(serversList[0],serverName)"
							data-dismiss="modal">Zapisz</button>
					</div>
				</div>
			</div>
		</div>
	</form>
	<!-- =========================================================================== -->
	<!-- ==================modal dialog  new user =========================== -->

	<form name="newUserForm" novalidate>
		<div class="modal fade" id="newUserDialog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
			aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
						<h4 class="modal-title" id="myModalLabel">Edytuj</h4>
					</div>
					<div class="modal-body">

						<div class="form-group">
							<label for="input_name" class="control-label">Nazwa:</label>
							<span class="alert-danger" data-ng-show="newUserForm.name.$error.required"> Wymagana!</span>
							<input name="name" type="text" class="form-control" id="input_name" data-ng-model="newUser.userName" required>
						</div>
						<div class="form-group">
							<label for="input_name" class="control-label">Hasło:</label> <input name="password" type="password"
								class="form-control" id="input_name" data-ng-model="newUser.userPassword" required>
						</div>
						<!-- roles option -->
						<div class="form-group">
							<label for="input_role" class="control-label">Rola:</label>
							<span class="alert-danger" data-ng-show="newUserForm.roleType.$error.required"> Wymagany!</span>
							<select name="roleType" id="input_role" class="form-control" data-ng-model="newUser.roles" multiple
								data-ng-options="roleTypes.type as roleTypes.name for roleTypes in securityRoles" required>
							</select>
						</div>
						<div class="form-group">
							<label for="input_enabled">Czy aktywny: <input name="input_enabled" type="checkbox" id="input_enabled"
								data-ng-model="newdUser.enabled" required>
							</label>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Anuluj</button>
						<button type="button" class="btn btn-primary" data-ng-click="addUser(newUser)" data-dismiss="modal">Zapisz</button>
					</div>
				</div>
			</div>
		</div>
	</form>




	<!-- ==================modal dialog edit userName =========================== -->
	<!-- Modal -->
	<form name="updateUserForm" novalidate>
		<div class="modal fade" id="updateUserDialog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
			aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
						<h4 class="modal-title" id="myModalLabel">Edytuj</h4>
					</div>
					<div class="modal-body">

						<div class="form-group">
							<label for="input_name" class="control-label">Nazwa:</label>
							<span class="alert-danger" data-ng-show="addUserForm.name.$error.required"> Wymagana!</span>
							<input name="name" type="text" class="form-control" id="input_name" data-ng-model="updatedUser.userName" required>
						</div>
						<div class="form-group">
							<label for="input_password" class="control-label">Hasło:<small
								style="font-family: cursive; font-stretch: condensed;"> (w przypadku pozostawienia pustego pola hasło
									pozostanie niezmienione)</small></label>
							<span class="alert-danger" data-ng-show="addUserForm.password.$error.required"> Wymagana!</span>
							<input name="password" type="password" class="form-control" id="input_password"
								data-ng-model="updatedUser.userPassword" required>
						</div>
						<!-- roles option -->
						<label for="input_role" class="control-label">Rola:</label>
						<span class="alert-danger" data-ng-show="updateUserForm.roleType.$error.required"> Wymagany!</span>
						<select name="roleType" id="input_role" class="form-control" data-ng-model="updatedUser.roles" multiple
							data-ng-options="roleTypes.type as roleTypes.name for roleTypes in securityRoles" required>
						</select>

						<div class="form-group">
							<label for="input_enabled">Czy aktywny: <input name="input_enabled" type="checkbox" id="input_enabled"
								data-ng-model="updatedUser.enabled" required>
							</label>
						</div>
					</div>

				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">Anuluj</button>
					<button type="button" class="btn btn-primary" data-ng-click="updateUser(updatedUser);" data-dismiss="modal">Zapisz</button>
				</div>
			</div>
		</div>
	
	</form>
	<!-- =========================================================================== -->
	<!-- <div data-ng-include="" src="edit_price_modal.html"></div> -->
	<div data-ng-include="" src="'view/admin/edit_price_modal.html'"></div>

</body>
</html>
